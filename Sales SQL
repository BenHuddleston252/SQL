#In this SQL, I'm querying a database with multiple tables to quantify customer and order data statistics.


-- How many orders did we get in January?
SELECT 
COUNT(DISTINCT orderID)
FROM JanSales
WHERE LENGTH(orderID) = 6
AND orderID <> 'Order ID';


-- How many of those January orders were for an iPhone?
SELECT 
COUNT(DISTINCT orderID) AS iphone_orders
FROM JanSales
WHERE Product = 'iPhone'
AND LENGTH(orderID) = 6
AND Product <> 'Product';

-- Select the customer account numbers for all the orders placed in February.
SELECT 
c.acctnum
FROM customers AS c
JOIN FebSales AS fs
ON c.order_ID = fs.orderID
WHERE fs.orderID <> 'Order ID'
AND LENGTH(fs.orderID) = 6;

-- Which product was the cheapest sold in January, and what was the price?
SELECT 
product,
price
FROM JanSales
ORDER BY price ASC
LIMIT 1;

-- What is the total revenue for each product sold in January? 
SELECT 
product,
ROUND(SUM(quantity*price)) AS revenue
FROM JanSales
WHERE product <> 'Product'
GROUP BY product
ORDER BY revenue DESC;

-- Which products were sold in February at 548 Lincoln St, Seattle, WA 98101, how many of each were sold, and what was the total revenue?
SELECT 
product,
SUM(quantity) AS total_sold,
SUM(quantity*price) AS revenue
FROM FebSales
WHERE location = '548 Lincoln St, Seattle, WA 98101'
GROUP BY product;

-- How many customers ordered more than 2 products at a time in February, and what was the average amount spent for those customers?
SELECT 
COUNT(DISTINCT c.acctnum) AS total_customers,
ROUND(SUM(quantity*price)/COUNT(DISTINCT c.acctnum)) avg_spent
FROM FebSales fs
LEFT JOIN customers c
ON fs.orderID=c.order_id
WHERE quantity > 2;

-- List all the products sold in Los Angeles in February, and include how many were sold for each product.
SELECT
product,
SUM(quantity) AS total_sold,
location
FROM FebSales
WHERE location LIKE '%Los Angeles%'
GROUP BY product;

-- Which locations in New York received at least 3 orders in January, and how many orders did they each receive?
SELECT 
location, 
COUNT(orderID) AS order_count
FROM JanSales
WHERE location LIKE '%NY%'
AND LENGTH(orderID) = 6
AND orderID <> 'Order ID'
GROUP BY location
HAVING COUNT(orderID) >= 3;

-- How many of each type of headphones were sold in February?
SELECT 
product, 
SUM(quantity) AS total_quantity
FROM FebSales
WHERE product LIKE '%headphone%'
GROUP BY product;

-- What was the average amount spent per account in February?
SELECT
ROUND(SUM(quantity*price)/COUNT(DISTINCT c.acctnum)) AS avg_spent
FROM FebSales fs
JOIN customers c
ON fs.orderID = c.order_id
WHERE order_id <> 'Order ID'
AND LENGTH(order_id) = 6;

-- What was the average quantity of products purchased per account in February? 
SELECT 
ROUND(SUM(quantity)/COUNT(DISTINCT c.acctnum),2) AS avg_quantity
FROM FebSales fs
JOIN customers c
ON fs.orderID = c.order_id
WHERE orderID <> 'Order ID'
AND LENGTH(orderID) = 6;

-- Which product brought in the most revenue in January and how much was it?
SELECT 
product, 
SUM(quantity*price) AS revenue
FROM JanSales
GROUP BY product
ORDER BY revenue DESC
LIMIT 1;

